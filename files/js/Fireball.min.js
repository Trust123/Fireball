if(!Fireball){var Fireball={}}$.widget("ui.fireSlide",{_buttonList:null,_count:0,_index:0,_items:null,_itemContainer:null,_timer:null,options:{speed:2000},_width:0,_create:function(){var b=this.element.children("div");this._itemContainer=$("<div />").appendTo(this.element).css("left",0);b.appendTo(this._itemContainer);this._items=this._itemContainer.children("div");this._count=this._items.length;this._index=0;var c=0;this._width=this.element.innerWidth();this._items.each($.proxy(function(e,f){$(f).css({left:(e*(40+this._width)),width:this._width}).show()},this));this._buttonList=$('<ul class="slideshowButtonList" />').appendTo(this.element);for(var d=0;d<this._count;d++){if($(this._items.get(d)).outerHeight()>=c){c=$(this._items.get(d)).outerHeight()}var a=$('<li><a><span class="icon icon16 fa-circle"></span></a></li>').click($.proxy(this._click,this)).appendTo(this._buttonList);if(d==0){a.addClass("active")}}this.element.css("height",c);$(window).resize($.proxy(this._resize,this));this._restartTimer()},_click:function(a){a.preventDefault();this.slideTo($(a.currentTarget).index());this._restartTimer()},_resize:function(){var a=0;for(var b=0;b<this._count;b++){if($(this._items.get(b)).outerHeight()>=a){a=$(this._items.get(b)).outerHeight()}}this.element.css("height",a);this._width=this.element.innerWidth();this._items.each($.proxy(function(c,d){$(d).css({left:(c*(40+this._width)),width:this._width})},this));this._index=0;this.slideTo()},_restartTimer:function(){if(this._timer!==null){window.clearInterval(this._timer)}this._timer=window.setInterval($.proxy(this.slideTo,this),this.options.speed)},slideTo:function(a){if(typeof a!=="undefined"){this._index=a}else{this._index=this._index+1}if(this._index==this._count){this._index=0}this._buttonList.find(".active").removeClass("active");$(this._buttonList.children().get(this._index)).addClass("active");this._itemContainer.css({left:(this._index*(40+this._width)*-1)})}});Fireball.Page={};Fireball.Page.Add=Class.extend({_pageID:0,_cache:{},_dialog:null,init:function(a){this._pageID=a;$("#pageAddButton").click($.proxy(this._click,this))},_click:function(a){a.preventDefault();this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)});this._proxy.setOption("data",{actionName:"getAddDialog",className:"cms\\data\\page\\PageAction",objectIDs:[this._pageID]});this._proxy.sendRequest()},_show:function(a){this._dialog=$('<div id="pageAddDialog">'+this._cache[a]+"</div>").appendTo(document.body);this._dialog.wcfDialog({title:WCF.Language.get("cms.page.add")});this._dialog.find("input[type=submit]").click($.proxy(this._submit,this))},_submit:function(a){a.preventDefault();parameters={};$("#pageAddForm input, #pageAddForm textarea, #pageAddForm select").each(function(c){var b=$(this);if(b.attr("type")!="checkbox"){parameters[b.attr("name")]=$.trim(b.val())}else{parameters[b.attr("name")]=b.prop("checked")?1:0}});this._proxy=new WCF.Action.Proxy({success:$.proxy(this._executed,this)});this._proxy.setOption("data",{actionName:"frontendCreate",className:"cms\\data\\page\\PageAction",objectIDs:[this._pageID],parameters:{data:parameters}});this._proxy.sendRequest()},_executed:function(b,d,a){if(typeof this._cache[b.returnValues.errors]==="undefined"){var c=new WCF.System.Notification(WCF.Language.get("wcf.global.success"));c.show(function(){window.location=b.returnValues.link})}},_success:function(b,c,a){this._cache[b.returnValues.pageID]=b.returnValues.template;this._show(b.returnValues.pageID)}});Fireball.Page.ContentTypes=Class.extend({_pageID:0,_proxy:null,_initialized:0,_cache:{},init:function(a){this._pageID=a;this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)});this._proxy.setOption("data",{actionName:"getContentTypes",className:"cms\\data\\page\\PageAction",objectIDs:[this._pageID],parameters:{position:"both"}});this._proxy.sendRequest()},_success:function(b,c,a){this._cache[b.returnValues.pageID]=b.returnValues.template;$("body").append(b.returnValues.template);$("body").append($('<a id="contentTypeListOpen" class="button buttonPrimary"><span class="icon icon32 fa-angle-right"></span></a>'));$("#contentTypeListOpen").click($.proxy(this._toggleSidebar,this));$("#contentTypeListClose").click($.proxy(this._toggleSidebar,this))},_toggleSidebar:function(a){a.preventDefault();if(!$("#contentTypeList").hasClass("open")){if(!this._initialized){new Fireball.Content.Dragging(this._pageID);this._initialized=1}$("#contentTypeList").addClass("open");$("#contentTypeListOpen").toggle()}else{$("#contentTypeList").removeClass("open");$("#contentTypeListOpen").toggle()}}});Fireball.Content={};Fireball.Content.Dragging=Class.extend({_proxy:null,_pageID:0,init:function(a){this._pageID=a;$("div[id^='cmsContent']").each(function(){$(this).remove()});$("section[id^='cmsContent']").each(function(){$(this).remove()});this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)});this._proxy.setOption("data",{actionName:"getSortableContentList",className:"cms\\data\\page\\PageAction",objectIDs:[this._pageID],parameters:{position:"body"}});this._proxy.sendRequest();this._proxy.setOption("data",{actionName:"getSortableContentList",className:"cms\\data\\page\\PageAction",objectIDs:[this._pageID],parameters:{position:"sidebar"}});this._proxy.sendRequest();$(".draggable").draggable({cursor:"move",helper:"clone",revert:"invalid",containment:"document",drag:$.proxy(this._drag,this)})},_drag:function(a,b){b.helper.css("position","fixed");b.helper.css("margin-top",a.pageY);b.helper.css("margin-left",a.pageX);b.position.top=0;b.position.left=0},_drop:function(c,e){if(typeof e.draggable.attr("id")!=="undefined"&&e.draggable.attr("id").match("^de.codequake.cms")){$(c.target).append('<div class="draggedContent '+e.draggable.attr("id")+'" />');var b=e.draggable.attr("id");var a="body";if(typeof $(c.target).attr("id")!=="undefined"&&$(c.target).attr("id").match("^cmsContent")){var d=$(c.target).attr("id").replace("cmsContent","")}var f=0;if(typeof d!=="undefined"){f=d}new Fireball.Content.AddForm(this._pageID,a,b,f)}},_success:function(b,c,a){template=b.returnValues.template;if(b.returnValues.position=="body"){$(template).insertAfter($(".content .contentHeader"))}else{if(b.returnValues.position=="sidebar"){$("aside.sidebar").append(template)}else{if(b.returnValues.position=="sidebarLeft"){$("aside.boxesSidebarLeft").append(template)}else{if(b.returnValues.position=="sidebarRight"){$("aside.boxesSidebarRight").append(template)}}}}new Fireball.Content.Sortable.List();$container=$("#sortableContentList"+b.returnValues.position.charAt(0).toUpperCase()+b.returnValues.position.slice(1));if($container!==undefined){$container.parent().find(".ui-droppable").droppable({activeClass:"droppable-state-active",greedy:true,drop:$.proxy(this._drop,this)})}}});Fireball.Content.Sortable={};Fireball.Content.Sortable.List=WCF.Sortable.List.extend({init:function(){this._super("sortableContentListBody");$("#contentTypeList .wideButton").children('button[data-type="submit"]').click($.proxy(this._submit,this));this._className="cms\\data\\content\\ContentAction"},_success:function(b,c,a){this._super(b,c,a);window.location=location}});Fireball.Content.AddForm=Class.extend({_pageID:0,_cache:{},_dialog:null,init:function(b,a,c,d){this._pageID=b;this._proxy=new WCF.Action.Proxy({success:$.proxy(this._success,this)});this._proxy.setOption("data",{actionName:"getAddDialog",className:"cms\\data\\content\\ContentAction",objectIDs:[],parameters:{position:a,type:c,parentID:d,pageID:this._pageID}});this._proxy.sendRequest()},_show:function(a){this._dialog=$('<div id="contentAddDialog">'+this._cache[a]+"</div>").appendTo(document.body);this._dialog.wcfDialog({title:WCF.Language.get("cms.content.add")});this._dialog.find("input[type=submit]").click($.proxy(this._submit,this))},_executed:function(b,d,a){if(typeof b.returnValues.errors==="undefined"){this._dialog.wcfDialog("close");var c=new WCF.System.Notification(WCF.Language.get("wcf.global.success"));c.show(function(){window.location=location})}},_submit:function(a){a.preventDefault();parameters={};parameters.contentData={};parameters.contentData["columnData"]=[];$("#contentAddForm input, #contentAddForm textarea, #pageAddForm select").each(function(c){var b=$(this);if(b.attr("type")!="checkbox"){parameters[b.attr("name")]=$.trim(b.val())}else{parameters[b.attr("name")]=b.prop("checked")?1:0}if(typeof b.attr("name")!=="undefined"&&b.attr("name").match("^contentData")){delete parameters[b.attr("name")];if(b.attr("name").match("columnData")){parameters.contentData["columnData"].push($.trim(b.val()))}else{parameters.contentData[b.attr("id")]=$.trim(b.val())}if(typeof parameters.contentData["columnData"]!=="undefined"&&parameters.contentData["columnData"].length==0){delete parameters.contentData["columnData"]}}});this._proxy=new WCF.Action.Proxy({success:$.proxy(this._executed,this)});this._proxy.setOption("data",{actionName:"frontendCreate",className:"cms\\data\\content\\ContentAction",objectIDs:[],parameters:{data:parameters}});this._proxy.sendRequest()},_success:function(b,c,a){this._cache[this._pageID]=b.returnValues.template;this._show(this._pageID)}});